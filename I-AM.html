
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåå I‚ÄëAM‚ÄëSYSTEMS PREMIUM</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0e1a;
            --bg-secondary: #151b2e;
            --bg-card: #1a2235;
            --accent-primary: #00ffc8;
            --accent-secondary: #7afcff;
            --accent-purple: #a78bfa;
            --accent-pink: #f472b6;
            --text-primary: #e8f4ff;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: rgba(0, 255, 200, 0.15);
            --glow: 0 0 20px rgba(0, 255, 200, 0.3);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0a0e1a 0%, #1a1f35 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: "";
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 255, 200, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(167, 139, 250, 0.03) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* Animated background particles */
        .particles {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--accent-primary);
            border-radius: 50%;
            opacity: 0.3;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(100vh) translateX(0); }
            100% { transform: translateY(-100vh) translateX(100px); }
        }

        header {
            background: rgba(26, 34, 53, 0.8);
            backdrop-filter: blur(20px);
            padding: 1.25rem 2rem;
            border-bottom: 1px solid var(--border);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        h1 {
            color: var(--accent-primary);
            text-align: center;
            font-size: 2rem;
            font-weight: 800;
            letter-spacing: -0.5px;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 30px rgba(0, 255, 200, 0.5);
        }

        .subtitle {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        #tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
            padding: 0 1rem;
        }

        .tab {
            padding: 0.5rem 1rem;
            background: rgba(26, 34, 53, 0.6);
            backdrop-filter: blur(10px);
            color: var(--text-secondary);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            font-size: 0.85rem;
            letter-spacing: 0.3px;
        }

        .tab:hover {
            background: rgba(0, 255, 200, 0.1);
            border-color: var(--accent-primary);
            color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 255, 200, 0.2);
        }

        .tab.active {
            background: linear-gradient(135deg, rgba(0, 255, 200, 0.2), rgba(122, 252, 255, 0.15));
            border-color: var(--accent-primary);
            color: var(--accent-primary);
            box-shadow: 0 4px 16px rgba(0, 255, 200, 0.3);
        }

        main {
            padding: 2rem;
            max-width: 1600px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        #content-area {
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .status-bar {
            background: rgba(26, 34, 53, 0.6);
            backdrop-filter: blur(10px);
            padding: 0.75rem 1.5rem;
            margin-top: 1rem;
            border-radius: 0.75rem;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
            border: 1px solid var(--border);
        }

        .status-item {
            font-size: 0.85rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-item.connected {
            color: var(--accent-primary);
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-primary);
            box-shadow: 0 0 10px var(--accent-primary);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        button {
            padding: 0.625rem 1.25rem;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--bg-primary);
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.875rem;
            letter-spacing: 0.3px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(0, 255, 200, 0.2);
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 255, 200, 0.4);
        }

        button:active:not(:disabled) {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        button.secondary {
            background: rgba(26, 34, 53, 0.8);
            border: 1px solid var(--border);
            color: var(--accent-primary);
            box-shadow: none;
        }

        button.secondary:hover:not(:disabled) {
            background: rgba(0, 255, 200, 0.1);
            border-color: var(--accent-primary);
        }

        .card {
            background: rgba(26, 34, 53, 0.6);
            backdrop-filter: blur(20px);
            padding: 1.5rem;
            border-radius: 1rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: rgba(0, 255, 200, 0.3);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
        }

        .card h3 {
            color: var(--accent-primary);
            margin-bottom: 1rem;
            font-size: 1.125rem;
            font-weight: 600;
            letter-spacing: -0.3px;
        }

        input, textarea, select {
            width: 100%;
            padding: 0.75rem 1rem;
            background: rgba(10, 14, 26, 0.6);
            color: var(--text-primary);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
            font-family: inherit;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(0, 255, 200, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
            line-height: 1.6;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 1.5rem;
        }

        /* Premium Video Feed Styles */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .video-card {
            background: rgba(26, 34, 53, 0.6);
            backdrop-filter: blur(20px);
            border-radius: 1rem;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .video-card:hover {
            transform: translateY(-4px);
            border-color: var(--accent-primary);
            box-shadow: 0 12px 40px rgba(0, 255, 200, 0.2);
        }

        .video-thumbnail {
            width: 100%;
            height: 180px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        .video-thumbnail::before {
            content: '';
            position: absolute;
            inset: 0;
            background: 
                radial-gradient(circle at 30% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 70% 80%, rgba(255, 255, 255, 0.08) 0%, transparent 50%);
        }

        .video-play-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background: rgba(0, 255, 200, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--bg-primary);
            box-shadow: 0 8px 24px rgba(0, 255, 200, 0.4);
            transition: all 0.3s ease;
        }

        .video-card:hover .video-play-icon {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 12px 32px rgba(0, 255, 200, 0.6);
        }

        .video-duration {
            position: absolute;
            bottom: 0.75rem;
            right: 0.75rem;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .video-info {
            padding: 1rem;
        }

        .video-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .video-meta-item {
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }

        /* Premium Social Feed Styles */
        .feed-container {
            max-width: 700px;
            margin: 0 auto;
        }

        .feed-item {
            background: rgba(26, 34, 53, 0.6);
            backdrop-filter: blur(20px);
            padding: 1.5rem;
            border-radius: 1rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .feed-item:hover {
            border-color: rgba(0, 255, 200, 0.3);
        }

        .feed-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .feed-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.2rem;
            box-shadow: 0 4px 12px rgba(0, 255, 200, 0.3);
        }

        .feed-user-info {
            flex: 1;
        }

        .feed-username {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.125rem;
        }

        .feed-timestamp {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .feed-content {
            color: var(--text-primary);
            line-height: 1.6;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .feed-actions {
            display: flex;
            gap: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        .feed-action {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(10, 14, 26, 0.4);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
        }

        .feed-action:hover {
            background: rgba(0, 255, 200, 0.1);
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .feed-action.active {
            background: rgba(0, 255, 200, 0.1);
            color: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        /* Agent Cards */
        .agent-card {
            background: linear-gradient(135deg, rgba(0, 255, 200, 0.05), rgba(122, 252, 255, 0.03));
            padding: 1.25rem;
            border-radius: 0.75rem;
            border: 1px solid rgba(0, 255, 200, 0.2);
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .agent-card:hover {
            background: linear-gradient(135deg, rgba(0, 255, 200, 0.1), rgba(122, 252, 255, 0.06));
            border-color: var(--accent-primary);
            transform: translateX(4px);
        }

        .agent-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .agent-name {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .agent-status {
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .agent-status.idle {
            background: rgba(100, 116, 139, 0.2);
            color: var(--text-muted);
        }

        .agent-status.working {
            background: rgba(0, 255, 200, 0.2);
            color: var(--accent-primary);
            animation: pulse 2s infinite;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(26, 34, 53, 0.8), rgba(26, 34, 53, 0.4));
            backdrop-filter: blur(20px);
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 1px solid var(--border);
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 255, 200, 0.15);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Code Editor */
        .code-editor {
            background: rgba(10, 14, 26, 0.8);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            overflow: hidden;
        }

        .code-editor-header {
            background: rgba(26, 34, 53, 0.8);
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
        }

        .code-editor-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 500;
        }

        .code-editor textarea {
            background: rgba(10, 14, 26, 0.9);
            color: #e8f4ff;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 0.875rem;
            border: none;
            min-height: 300px;
            line-height: 1.6;
            tab-size: 2;
        }

        .code-output {
            background: rgba(0, 0, 0, 0.6);
            color: var(--accent-primary);
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            min-height: 150px;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 1rem;
            border: 1px solid var(--border);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            background: rgba(26, 34, 53, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            padding: 1rem 1.25rem;
            max-width: 380px;
            z-index: 9999;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification.success {
            border-left: 4px solid var(--accent-primary);
        }

        .notification.error {
            border-left: 4px solid #ef4444;
        }

        .notification-content {
            display: flex;
            align-items: start;
            gap: 0.75rem;
        }

        .notification-icon {
            font-size: 1.25rem;
        }

        .notification-text {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-size: 0.9rem;
        }

        .notification-message {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        /* Pipeline Visualization */
        .pipeline-step {
            background: linear-gradient(135deg, rgba(26, 34, 53, 0.6), rgba(26, 34, 53, 0.4));
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            margin-bottom: 0.75rem;
            position: relative;
        }

        .pipeline-step::after {
            content: '‚Üì';
            position: absolute;
            bottom: -1.25rem;
            left: 50%;
            transform: translateX(-50%);
            color: var(--accent-primary);
            font-size: 1.25rem;
        }

        .pipeline-step:last-child::after {
            display: none;
        }

        /* Knowledge Sources */
        .knowledge-source {
            background: rgba(26, 34, 53, 0.4);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .knowledge-source:hover {
            background: rgba(0, 255, 200, 0.05);
            border-color: var(--accent-primary);
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(10, 14, 26, 0.4);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 255, 200, 0.3);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 255, 200, 0.5);
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.5rem; }
            main { padding: 1rem; }
            .grid { grid-template-columns: 1fr; }
            .video-grid { grid-template-columns: 1fr; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>

<body>
    <div class="particles" id="particles"></div>

    <header>
        <h1>üåå I‚ÄëAM‚ÄëSYSTEMS PREMIUM</h1>
        <div class="subtitle">Next-Generation Decentralized Universe</div>

        <div id="tabs">
            <div class="tab active" data-tab="home">üè† Home</div>
            <div class="tab" data-tab="agents">ü§ñ Agents</div>
            <div class="tab" data-tab="pipelines">‚ö° Pipelines</div>
            <div class="tab" data-tab="ai">üß† AI Hub</div>
            <div class="tab" data-tab="social">üì± Social</div>
            <div class="tab" data-tab="video">üé¨ Video</div>
            <div class="tab" data-tab="code">üíª Code</div>
            <div class="tab" data-tab="knowledge">üìö Knowledge</div>
            <div class="tab" data-tab="dex">üîÑ DEX</div>
            <div class="tab" data-tab="blockchain">‚õìÔ∏è Chain</div>
        </div>

        <div class="status-bar">
            <div class="status-item connected">
                <div class="status-indicator"></div>
                <span id="wallet-status">System Active</span>
            </div>
            <div class="status-item">
                Agents: <span id="agents-count">0</span>
            </div>
            <div class="status-item">
                Posts: <span id="posts-count">0</span>
            </div>
            <div class="status-item">
                Videos: <span id="videos-count">0</span>
            </div>
            <div class="status-item">
                Knowledge: <span id="knowledge-count">0</span>
            </div>
        </div>
    </header>

    <main>
        <div id="content-area"></div>
    </main>

    <script>
        // ============================================
        // SYSTEM ENGINE (Same as Ultimate V2)
        // ============================================
        class UltimateSystem {
            constructor() {
                this.walletAddress = this.generateAddress();
                this.chain = [];
                this.agents = [];
                this.pipelines = [];
                this.posts = [];
                this.knowledgeBase = [];
                this.videos = [];
                this.codeScripts = [];
                this.balances = new Map();
                this.pools = new Map();
                this.nfts = [];
                this.stats = { trades: 0, volume: 0, fees: 0 };
                this.FEE_PERCENT = 0.003;
                this.initializeSystem();
            }

            generateAddress() {
                return '0x' + Array.from({length: 40}, () => Math.floor(Math.random() * 16).toString(16)).join('');
            }

            async sha256(data) {
                const str = typeof data === 'string' ? data : JSON.stringify(data);
                const buffer = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
                return Array.from(new Uint8Array(buffer)).map(b => b.toString(16).padStart(2, '0')).join('');
            }

            initializeSystem() {
                this.chain.push({
                    index: 0,
                    timestamp: Date.now(),
                    data: {type: 'GENESIS'},
                    hash: '0'.repeat(64),
                    previousHash: '0'.repeat(64)
                });

                this.balances.set(this.walletAddress, {'IAM': 1000, 'ETH': 5, 'USDC': 10000});
                this.pools.set('IAM-ETH', {tokenA: 'IAM', tokenB: 'ETH', reserveA: 10000, reserveB: 10, lpSupply: 100});

                this.createAgent('Content Creator', 'Creates engaging social media posts', 'social');
                this.createAgent('Code Analyzer', 'Analyzes and reviews code', 'code');
                this.createAgent('Trading Bot', 'Executes trades on DEX', 'trading');
            }

            async addBlock(action, data) {
                const prev = this.chain[this.chain.length - 1];
                const block = {index: this.chain.length, timestamp: Date.now(), data: {action, ...data}, previousHash: prev.hash};
                block.hash = await this.sha256(block);
                this.chain.push(block);
                return block;
            }

            createAgent(name, description, type) {
                const agent = {
                    id: 'agent-' + Date.now(),
                    name,
                    description,
                    type,
                    status: 'idle',
                    tasksCompleted: 0,
                    created: Date.now()
                };
                this.agents.push(agent);
                return agent;
            }

            async executeAgent(agentId, task) {
                const agent = this.agents.find(a => a.id === agentId);
                if (!agent) throw new Error('Agent not found');

                agent.status = 'working';
                agent.tasksCompleted++;

                await this.addBlock('AGENT_EXECUTE', {agentId: agent.id, task});
                await new Promise(resolve => setTimeout(resolve, 1000));

                let result = '';
                if (agent.type === 'social') {
                    result = `Generated post: "${task.substring(0, 50)}..." with trending hashtags`;
                } else if (agent.type === 'code') {
                    result = `Code analysis complete. Found 0 critical issues.`;
                } else if (agent.type === 'trading') {
                    result = `Trade executed: ${task}`;
                } else {
                    result = `Task completed: ${task}`;
                }

                agent.status = 'idle';
                return result;
            }

            createPipeline(name, steps) {
                const pipeline = {
                    id: 'pipeline-' + Date.now(),
                    name,
                    steps,
                    status: 'ready',
                    executions: 0,
                    created: Date.now()
                };
                this.pipelines.push(pipeline);
                return pipeline;
            }

            async executePipeline(pipelineId, input) {
                const pipeline = this.pipelines.find(p => p.id === pipelineId);
                if (!pipeline) throw new Error('Pipeline not found');

                pipeline.status = 'running';
                pipeline.executions++;

                const results = [];
                let currentInput = input;

                for (const step of pipeline.steps) {
                    const agent = this.agents.find(a => a.id === step.agentId);
                    if (agent) {
                        const result = await this.executeAgent(step.agentId, currentInput);
                        results.push({step: step.name, result});
                        currentInput = result;
                    }
                }

                await this.addBlock('PIPELINE_EXECUTE', {pipelineId, input, results: results.length});
                pipeline.status = 'ready';
                return results;
            }

            createPost(author, content, media = null) {
                const post = {
                    id: 'post-' + Date.now(),
                    author,
                    content,
                    media,
                    likes: 0,
                    comments: [],
                    timestamp: Date.now()
                };
                this.posts.unshift(post);
                this.addBlock('POST_CREATE', {postId: post.id, author});
                return post;
            }

            likePost(postId) {
                const post = this.posts.find(p => p.id === postId);
                if (post) post.likes++;
            }

            commentOnPost(postId, author, comment) {
                const post = this.posts.find(p => p.id === postId);
                if (post) post.comments.push({author, comment, timestamp: Date.now()});
            }

            async addKnowledge(source, type, content) {
                const knowledge = {
                    id: 'kb-' + Date.now(),
                    source,
                    type,
                    content,
                    indexed: Date.now(),
                    tokens: content.split(/\s+/).length
                };
                this.knowledgeBase.push(knowledge);
                await this.addBlock('KNOWLEDGE_ADD', {source, type, tokens: knowledge.tokens});
                return knowledge;
            }

            searchKnowledge(query) {
                return this.knowledgeBase.filter(kb => 
                    kb.content.toLowerCase().includes(query.toLowerCase())
                );
            }

            getBalance(token) {
                const bal = this.balances.get(this.walletAddress);
                return bal ? bal[token] || 0 : 0;
            }

            updateBalance(token, amount) {
                const bal = this.balances.get(this.walletAddress);
                if (bal) bal[token] = (bal[token] || 0) + amount;
            }

            getPool(tokenA, tokenB) {
                const key = [tokenA, tokenB].sort().join('-');
                return this.pools.get(key);
            }

            calculateSwapOutput(amountIn, reserveIn, reserveOut) {
                if (amountIn <= 0) return 0;
                const amountInWithFee = amountIn * (1 - this.FEE_PERCENT);
                return (amountInWithFee * reserveOut) / (reserveIn + amountInWithFee);
            }

            async executeSwap(fromToken, toToken, amountIn) {
                const pool = this.getPool(fromToken, toToken);
                if (!pool) throw new Error('No pool');

                const isNormal = pool.tokenA === fromToken;
                const reserveIn = isNormal ? pool.reserveA : pool.reserveB;
                const reserveOut = isNormal ? pool.reserveB : pool.reserveA;
                const amountOut = this.calculateSwapOutput(amountIn, reserveIn, reserveOut);

                if (isNormal) {
                    pool.reserveA += amountIn;
                    pool.reserveB -= amountOut;
                } else {
                    pool.reserveB += amountIn;
                    pool.reserveA -= amountOut;
                }

                this.updateBalance(fromToken, -amountIn);
                this.updateBalance(toToken, amountOut);
                this.stats.trades++;

                await this.addBlock('SWAP', {fromToken, toToken, amountIn, amountOut});
                return {amountOut};
            }

            async uploadVideo(name, description, duration = '5:23') {
                const video = {
                    id: 'vid-' + Date.now(),
                    name,
                    description,
                    duration,
                    views: Math.floor(Math.random() * 1000),
                    likes: Math.floor(Math.random() * 100),
                    created: Date.now()
                };
                this.videos.push(video);
                await this.addBlock('VIDEO_UPLOAD', {videoId: video.id});
                return video;
            }

            async saveCode(name, language, code) {
                const script = {
                    id: 'script-' + Date.now(),
                    name,
                    language,
                    code,
                    executions: 0,
                    created: Date.now()
                };
                this.codeScripts.push(script);
                await this.addBlock('CODE_SAVE', {scriptId: script.id});
                return script;
            }

            async executeCode(scriptId) {
                const script = this.codeScripts.find(s => s.id === scriptId);
                if (!script) throw new Error('Script not found');
                script.executions++;

                let output = '';
                try {
                    if (script.language === 'javascript') {
                        const logs = [];
                        const customConsole = {
                            log: (...args) => logs.push(args.join(' '))
                        };
                        const func = new Function('console', 'system', script.code);
                        func(customConsole, {
                            chain: this.chain.length,
                            balance: this.getBalance('IAM')
                        });
                        output = logs.join('\n') || 'Execution completed';
                    } else {
                        output = `${script.language} execution simulated`;
                    }
                } catch (e) {
                    output = `ERROR: ${e.message}`;
                }

                await this.addBlock('CODE_EXECUTE', {scriptId});
                return {output};
            }
        }

        const system = new UltimateSystem();

        // Create animated particles
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(particle);
            }
        }

        createParticles();

        // ============================================
        // UI CONTROLLER
        // ============================================
        document.getElementById('tabs').addEventListener('click', (e) => {
            if (e.target.classList.contains('tab')) {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                e.target.classList.add('active');
                renderTab(e.target.dataset.tab);
            }
        });

        function renderTab(tab) {
            const content = document.getElementById('content-area');
            switch(tab) {
                case 'home': renderHome(content); break;
                case 'agents': renderAgents(content); break;
                case 'pipelines': renderPipelines(content); break;
                case 'ai': renderAI(content); break;
                case 'social': renderSocial(content); break;
                case 'video': renderVideo(content); break;
                case 'code': renderCode(content); break;
                case 'knowledge': renderKnowledge(content); break;
                case 'dex': renderDEX(content); break;
                case 'blockchain': renderBlockchain(content); break;
            }
        }

        function renderHome(c) {
            c.innerHTML = `
                <h2 style="color: var(--accent-primary); font-size: 2rem; margin-bottom: 2rem; font-weight: 700;">Welcome to I‚ÄëAM‚ÄëSYSTEMS Premium</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${system.agents.length}</div>
                        <div class="stat-label">AI Agents</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${system.pipelines.length}</div>
                        <div class="stat-label">Pipelines</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${system.posts.length}</div>
                        <div class="stat-label">Posts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${system.videos.length}</div>
                        <div class="stat-label">Videos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${system.knowledgeBase.length}</div>
                        <div class="stat-label">Knowledge</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${system.chain.length}</div>
                        <div class="stat-label">Blocks</div>
                    </div>
                </div>

                <div class="card" style="margin-top: 2rem;">
                    <h3>‚ö° Quick Actions</h3>
                    <button onclick="runFullDemo()">Run Full Demo</button>
                    <button class="secondary" onclick="switchTab('agents')">Manage Agents</button>
                    <button class="secondary" onclick="switchTab('video')">Browse Videos</button>
                    <button class="secondary" onclick="switchTab('social')">Social Feed</button>
                </div>
            `;
        }

        function renderAgents(c) {
            c.innerHTML = `
                <h2 style="color: var(--accent-primary); font-size: 1.75rem; margin-bottom: 1.5rem; font-weight: 700;">AI Agents</h2>
                
                <div class="grid">
                    <div class="card">
                        <h3>Create New Agent</h3>
                        <input type="text" id="agentName" placeholder="Agent Name">
                        <textarea id="agentDesc" placeholder="Agent Description" rows="3"></textarea>
                        <select id="agentType">
                            <option value="social">Social Media</option>
                            <option value="code">Code Analysis</option>
                            <option value="trading">Trading</option>
                            <option value="content">Content Creation</option>
                            <option value="research">Research</option>
                        </select>
                        <button onclick="createAgent()">Create Agent</button>
                    </div>

                    <div class="card">
                        <h3>Active Agents (${system.agents.length})</h3>
                        <div style="max-height: 500px; overflow-y: auto;">
                            ${system.agents.map(a => `
                                <div class="agent-card">
                                    <div class="agent-header">
                                        <div class="agent-name">${a.name}</div>
                                        <div class="agent-status ${a.status}">${a.status}</div>
                                    </div>
                                    <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.75rem;">
                                        ${a.description}
                                    </div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">
                                        Type: ${a.type} ‚Ä¢ Tasks: ${a.tasksCompleted}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderPipelines(c) {
            c.innerHTML = `
                <h2 style="color: var(--accent-primary); font-size: 1.75rem; margin-bottom: 1.5rem; font-weight: 700;">Automation Pipelines</h2>
                
                <div class="card">
                    <h3>Active Pipelines (${system.pipelines.length})</h3>
                    ${system.pipelines.length === 0 ? 
                        '<p style="color: var(--text-muted); text-align: center; padding: 2rem;">No pipelines yet. Create your first automation!</p>' :
                        system.pipelines.map(p => `
                            <div class="agent-card">
                                <div class="agent-header">
                                    <div class="agent-name">${p.name}</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">${p.executions} runs</div>
                                </div>
                                <div style="margin-top: 0.75rem;">
                                    ${p.steps.map((s, i) => `
                                        <div class="pipeline-step">
                                            Step ${i + 1}: ${s.name}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')
                    }
                </div>
            `;
        }

        function renderAI(c) {
            c.innerHTML = `
                <h2 style="color: var(--accent-primary); font-size: 1.75rem; margin-bottom: 1.5rem; font-weight: 700;">AI Hub</h2>
                
                <div class="card">
                    <h3>Conversational AI</h3>
                    <div style="background: rgba(10, 14, 26, 0.6); padding: 1.5rem; border-radius: 0.75rem; min-height: 400px; margin-bottom: 1rem; border: 1px solid var(--border);" id="aiChat">
                        <div style="color: var(--text-muted); text-align: center; padding: 3rem;">
                            Start a conversation with the AI...
                        </div>
                    </div>
                    <textarea id="aiInput" placeholder="Type your message..." rows="2"></textarea>
                    <button onclick="sendAIMessage()">Send Message</button>
                </div>
            `;
        }

        function renderSocial(c) {
            c.innerHTML = `
                <h2 style="color: var(--accent-primary); font-size: 1.75rem; margin-bottom: 1.5rem; font-weight: 700;">Social Feed</h2>
                
                <div class="feed-container">
                    <div class="card">
                        <h3>Create Post</h3>
                        <textarea id="postContent" placeholder="What's on your mind?" rows="3"></textarea>
                        <button onclick="createPost()">Post</button>
                        <button class="secondary" onclick="createPostWithAI()">‚ú® Generate with AI</button>
                    </div>

                    ${system.posts.length === 0 ? 
                        '<div class="card"><p style="text-align: center; color: var(--text-muted); padding: 2rem;">No posts yet. Be the first to post!</p></div>' :
                        system.posts.map(p => `
                            <div class="feed-item">
                                <div class="feed-header">
                                    <div class="feed-avatar">${p.author.substring(2, 4).toUpperCase()}</div>
                                    <div class="feed-user-info">
                                        <div class="feed-username">${p.author.substring(0, 12)}...</div>
                                        <div class="feed-timestamp">${new Date(p.timestamp).toLocaleString()}</div>
                                    </div>
                                </div>
                                <div class="feed-content">${p.content}</div>
                                <div class="feed-actions">
                                    <div class="feed-action ${p.likes > 0 ? 'active' : ''}" onclick="likePost('${p.id}')">
                                        ‚ù§Ô∏è ${p.likes}
                                    </div>
                                    <div class="feed-action" onclick="commentPost('${p.id}')">
                                        üí¨ ${p.comments.length}
                                    </div>
                                </div>
                            </div>
                        `).join('')
                    }
                </div>
            `;
        }

        function renderVideo(c) {
            c.innerHTML = `
                <h2 style="color: var(--accent-primary); font-size: 1.75rem; margin-bottom: 1.5rem; font-weight: 700;">Video Platform</h2>
                
                <div class="card" style="margin-bottom: 2rem;">
                    <h3>Upload Video</h3>
                    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
                        <input type="text" id="videoName" placeholder="Video title">
                        <textarea id="videoDesc" placeholder="Description" rows="2"></textarea>
                        <button onclick="uploadVideo()">Upload Video</button>
                    </div>
                </div>

                <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.25rem; font-weight: 600;">
                    ${system.videos.length === 0 ? 'No videos yet' : `Video Library (${system.videos.length})`}
                </h3>
                <div class="video-grid">
                    ${system.videos.length === 0 ?
                        '<div class="card" style="grid-column: 1/-1;"><p style="text-align: center; color: var(--text-muted); padding: 2rem;">Upload your first video!</p></div>' :
                        system.videos.map((v, i) => {
                            const gradients = [
                                'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                                'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                                'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                                'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
                                'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
                                'linear-gradient(135deg, #30cfd0 0%, #330867 100%)'
                            ];
                            const gradient = gradients[i % gradients.length];
                            
                            return `
                            <div class="video-card" onclick="playVideo('${v.id}')">
                                <div class="video-thumbnail" style="background: ${gradient};">
                                    <div class="video-play-icon">‚ñ∂</div>
                                    <div class="video-duration">${v.duration}</div>
                                </div>
                                <div class="video-info">
                                    <div class="video-title">${v.name}</div>
                                    <div class="video-meta">
                                        <div class="video-meta-item">
                                            <span>üëÅÔ∏è</span>
                                            <span>${v.views.toLocaleString()}</span>
                                        </div>
                                        <div class="video-meta-item">
                                            <span>‚ù§Ô∏è</span>
                                            <span>${v.likes}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `}).join('')
                    }
                </div>
            `;
        }

        function renderCode(c) {
            c.innerHTML = `
                <h2 style="color: var(--accent-primary); font-size: 1.75rem; margin-bottom: 1.5rem; font-weight: 700;">Code Execution</h2>
                
                <div class="grid">
                    <div class="card">
                        <h3>Code Editor</h3>
                        <input type="text" id="scriptName" placeholder="Script name" style="margin-bottom: 0.75rem;">
                        <select id="scriptLang" style="margin-bottom: 0.75rem;">
                            <option value="javascript">JavaScript</option>
                            <option value="python">Python</option>
                        </select>
                        <div class="code-editor">
                            <div class="code-editor-header">
                                <div class="code-editor-title">
                                    <span>üíª</span>
                                    <span>Code Editor</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button onclick="saveCode()" style="padding: 0.375rem 0.75rem; font-size: 0.8rem;">üíæ Save</button>
                                    <button onclick="executeCode()" style="padding: 0.375rem 0.75rem; font-size: 0.8rem;">‚ñ∂Ô∏è Run</button>
                                </div>
                            </div>
                            <textarea id="codeEditor" placeholder="// Your code here
console.log('Hello from I-AM-SYSTEMS!');
console.log('Chain length:', system.chain);
console.log('Balance:', system.balance);"></textarea>
                        </div>
                        <div id="codeOutput" class="code-output" style="display: none;"></div>
                    </div>

                    <div class="card">
                        <h3>Saved Scripts (${system.codeScripts.length})</h3>
                        <div style="max-height: 500px; overflow-y: auto;">
                            ${system.codeScripts.length === 0 ?
                                '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No scripts saved yet</p>' :
                                system.codeScripts.map(s => `
                                    <div class="agent-card" onclick="loadScript('${s.id}')">
                                        <div class="agent-header">
                                            <div class="agent-name">üíª ${s.name}</div>
                                            <div style="font-size: 0.8rem; color: var(--text-muted);">‚ö° ${s.executions} runs</div>
                                        </div>
                                        <div style="background: rgba(10, 14, 26, 0.6); padding: 0.75rem; border-radius: 0.5rem; margin-top: 0.75rem; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: #94a3b8;">
                                            ${s.code.substring(0, 120)}${s.code.length > 120 ? '...' : ''}
                                        </div>
                                    </div>
                                `).join('')
                            }
                        </div>
                    </div>
                </div>
            `;
        }

        function renderKnowledge(c) {
            c.innerHTML = `
                <h2 style="color: var(--accent-primary); font-size: 1.75rem; margin-bottom: 1.5rem; font-weight: 700;">Knowledge Base</h2>
                
                <div class="grid">
                    <div class="card">
                        <h3>Add Knowledge</h3>
                        <select id="knowledgeType">
                            <option value="url">From URL</option>
                            <option value="text">Text Content</option>
                            <option value="file">File Upload</option>
                        </select>
                        <input type="text" id="knowledgeSource" placeholder="Source name or URL">
                        <textarea id="knowledgeContent" placeholder="Paste content here..." rows="6"></textarea>
                        <button onclick="addKnowledge()">Add to Knowledge Base</button>
                    </div>

                    <div class="card">
                        <h3>Knowledge Sources (${system.knowledgeBase.length})</h3>
                        <div style="max-height: 400px; overflow-y: auto;">
                            ${system.knowledgeBase.length === 0 ?
                                '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No knowledge sources yet</p>' :
                                system.knowledgeBase.map(kb => `
                                    <div class="knowledge-source">
                                        <div>
                                            <strong style="color: var(--text-primary);">${kb.source}</strong>
                                            <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                ${kb.type} ‚Ä¢ ${kb.tokens} tokens ‚Ä¢ ${new Date(kb.indexed).toLocaleDateString()}
                                            </div>
                                        </div>
                                        <button class="secondary" style="padding: 0.375rem 0.75rem; margin: 0;">View</button>
                                    </div>
                                `).join('')
                            }
                        </div>
                    </div>
                </div>
            `;
        }

        function renderDEX(c) {
            c.innerHTML = `
                <h2 style="color: var(--accent-primary); font-size: 1.75rem; margin-bottom: 1.5rem; font-weight: 700;">Decentralized Exchange</h2>
                
                <div class="grid">
                    <div class="card">
                        <h3>Token Swap</h3>
                        <label style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem; display: block;">From</label>
                        <div style="display: flex; gap: 0.75rem; margin-bottom: 1rem;">
                            <input type="number" id="swapAmount" placeholder="0.0" style="flex: 1; margin: 0;">
                            <select id="swapFrom" style="width: 120px; margin: 0;">
                                <option value="IAM">IAM</option>
                                <option value="ETH">ETH</option>
                                <option value="USDC">USDC</option>
                            </select>
                        </div>
                        <div style="text-align: center; margin: 1rem 0; font-size: 1.5rem; color: var(--accent-primary);">‚áÖ</div>
                        <label style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem; display: block;">To</label>
                        <div style="display: flex; gap: 0.75rem;">
                            <input type="number" id="swapOutput" placeholder="0.0" readonly style="flex: 1; margin: 0;">
                            <select id="swapTo" style="width: 120px; margin: 0;">
                                <option value="ETH">ETH</option>
                                <option value="IAM">IAM</option>
                                <option value="USDC">USDC</option>
                            </select>
                        </div>
                        <button onclick="executeSwap()" style="width: 100%; margin-top: 1.5rem;">Execute Swap</button>
                    </div>

                    <div class="card">
                        <h3>Your Balances</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value">${system.getBalance('IAM').toFixed(2)}</div>
                                <div class="stat-label">IAM</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value">${system.getBalance('ETH').toFixed(4)}</div>
                                <div class="stat-label">ETH</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value">${system.getBalance('USDC').toFixed(2)}</div>
                                <div class="stat-label">USDC</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('swapAmount').addEventListener('input', updateSwapOutput);
        }

        function renderBlockchain(c) {
            c.innerHTML = `
                <h2 style="color: var(--accent-primary); font-size: 1.75rem; margin-bottom: 1.5rem; font-weight: 700;">Blockchain Explorer</h2>
                
                <div class="stats-grid" style="margin-bottom: 2rem;">
                    <div class="stat-card">
                        <div class="stat-value">${system.chain.length}</div>
                        <div class="stat-label">Total Blocks</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${system.stats.trades}</div>
                        <div class="stat-label">Transactions</div>
                    </div>
                </div>

                <div class="card">
                    <h3>Recent Blocks</h3>
                    <div style="max-height: 500px; overflow-y: auto;">
                        ${system.chain.slice().reverse().slice(0, 10).map(b => `
                            <div class="agent-card">
                                <div class="agent-header">
                                    <div class="agent-name">Block #${b.index}</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">${b.data.action || 'GENESIS'}</div>
                                </div>
                                <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.5rem; word-break: break-all;">
                                    Hash: ${b.hash.substring(0, 40)}...
                                </div>
                                <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                                    ${new Date(b.timestamp).toLocaleString()}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // ============================================
        // ACTION FUNCTIONS
        // ============================================

        function switchTab(tab) {
            const tabEl = Array.from(document.querySelectorAll('.tab')).find(t => t.dataset.tab === tab);
            if (tabEl) tabEl.click();
        }

        async function createAgent() {
            const name = document.getElementById('agentName').value;
            const desc = document.getElementById('agentDesc').value;
            const type = document.getElementById('agentType').value;
            if (!name) return showNotification('Agent Creation', 'Please enter agent name', 'error');
            system.createAgent(name, desc, type);
            showNotification('Success', 'Agent created successfully!', 'success');
            renderTab('agents');
            updateStatus();
        }

        async function createPost() {
            const content = document.getElementById('postContent').value;
            if (!content) return showNotification('Post Creation', 'Please enter content', 'error');
            system.createPost(system.walletAddress, content);
            showNotification('Success', 'Post created!', 'success');
            renderTab('social');
            updateStatus();
        }

        async function createPostWithAI() {
            const agent = system.agents.find(a => a.type === 'social');
            if (!agent) return showNotification('Error', 'No social agent found', 'error');
            const result = await system.executeAgent(agent.id, 'Create engaging social media post');
            document.getElementById('postContent').value = result;
            showNotification('Success', 'Post generated with AI!', 'success');
        }

        function likePost(postId) {
            system.likePost(postId);
            renderTab('social');
        }

        function commentPost(postId) {
            const comment = prompt('Enter your comment:');
            if (comment) {
                system.commentOnPost(postId, system.walletAddress, comment);
                renderTab('social');
            }
        }

        async function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            if (!message) return;

            const chat = document.getElementById('aiChat');
            chat.innerHTML += `
                <div style="margin-bottom: 1.5rem; text-align: right;">
                    <div style="background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); color: var(--bg-primary); padding: 1rem; border-radius: 1rem; display: inline-block; max-width: 80%; text-align: left; box-shadow: 0 4px 12px rgba(0, 255, 200, 0.3);">
                        ${message}
                    </div>
                </div>
            `;

            input.value = '';

            setTimeout(() => {
                chat.innerHTML += `
                    <div style="margin-bottom: 1.5rem;">
                        <div style="background: rgba(26, 34, 53, 0.8); padding: 1rem; border-radius: 1rem; display: inline-block; max-width: 80%; border: 1px solid var(--border);">
                            Based on "${message}", I can help you with:
                            <ul style="margin-top: 0.75rem; padding-left: 1.5rem; line-height: 1.8;">
                                <li>Managing ${system.agents.length} AI agents</li>
                                <li>Executing automation pipelines</li>
                                <li>Analyzing blockchain (${system.chain.length} blocks)</li>
                                <li>Creating content from knowledge base</li>
                            </ul>
                        </div>
                    </div>
                `;
                chat.scrollTop = chat.scrollHeight;
            }, 1000);
        }

        async function uploadVideo() {
            const name = document.getElementById('videoName').value;
            const desc = document.getElementById('videoDesc').value;
            if (!name) return showNotification('Video Upload', 'Please enter video name', 'error');

            await system.uploadVideo(name, desc);
            showNotification('Success', 'Video uploaded!', 'success');
            renderTab('video');
            updateStatus();
        }

        function playVideo(videoId) {
            const video = system.videos.find(v => v.id === videoId);
            if (video) {
                video.views++;
                showNotification('Playing', `Now playing: ${video.name}`, 'success');
                updateStatus();
            }
        }

        async function saveCode() {
            const name = document.getElementById('scriptName').value;
            const lang = document.getElementById('scriptLang').value;
            const code = document.getElementById('codeEditor').value;
            if (!name || !code) return showNotification('Save Code', 'Please enter name and code', 'error');

            await system.saveCode(name, lang, code);
            showNotification('Success', 'Code saved!', 'success');
            renderTab('code');
        }

        async function executeCode() {
            const code = document.getElementById('codeEditor').value;
            const lang = document.getElementById('scriptLang').value;
            if (!code) return showNotification('Execute Code', 'Please enter code', 'error');

            const temp = await system.saveCode('temp-' + Date.now(), lang, code);
            const result = await system.executeCode(temp.id);
            
            const outputEl = document.getElementById('codeOutput');
            outputEl.style.display = 'block';
            outputEl.textContent = result.output;
            showNotification('Success', 'Code executed!', 'success');
        }

        function loadScript(scriptId) {
            const script = system.codeScripts.find(s => s.id === scriptId);
            if (script) {
                document.getElementById('scriptName').value = script.name;
                document.getElementById('scriptLang').value = script.language;
                document.getElementById('codeEditor').value = script.code;
                showNotification('Loaded', `Loaded: ${script.name}`, 'success');
            }
        }

        async function addKnowledge() {
            const type = document.getElementById('knowledgeType').value;
            const source = document.getElementById('knowledgeSource').value;
            const content = document.getElementById('knowledgeContent').value;

            if (!source) return showNotification('Add Knowledge', 'Please enter source', 'error');
            if (!content && type === 'text') return showNotification('Add Knowledge', 'Please enter content', 'error');

            await system.addKnowledge(source, type, content || `Content from ${source}`);
            showNotification('Success', 'Knowledge added!', 'success');
            renderTab('knowledge');
            updateStatus();
        }

        function updateSwapOutput() {
            const amount = parseFloat(document.getElementById('swapAmount').value) || 0;
            const from = document.getElementById('swapFrom').value;
            const to = document.getElementById('swapTo').value;

            if (amount > 0 && from !== to) {
                const pool = system.getPool(from, to);
                if (pool) {
                    const isNormal = pool.tokenA === from;
                    const reserveIn = isNormal ? pool.reserveA : pool.reserveB;
                    const reserveOut = isNormal ? pool.reserveB : pool.reserveA;
                    const output = system.calculateSwapOutput(amount, reserveIn, reserveOut);
                    document.getElementById('swapOutput').value = output.toFixed(6);
                }
            }
        }

        async function executeSwap() {
            const from = document.getElementById('swapFrom').value;
            const to = document.getElementById('swapTo').value;
            const amount = parseFloat(document.getElementById('swapAmount').value);

            if (!amount || amount <= 0) return showNotification('Swap', 'Invalid amount', 'error');

            try {
                const result = await system.executeSwap(from, to, amount);
                showNotification('Success', `Swapped ${amount} ${from} for ${result.amountOut.toFixed(4)} ${to}!`, 'success');
                document.getElementById('swapAmount').value = '';
                document.getElementById('swapOutput').value = '';
                renderTab('dex');
            } catch (e) {
                showNotification('Error', e.message, 'error');
            }
        }

        async function runFullDemo() {
            showNotification('Demo', 'Running full system demo...', 'success');
            
            system.createAgent('Demo Agent', 'Demonstration agent', 'custom');
            const agent = system.agents[0];
            system.createPipeline('Demo Pipeline', [
                {name: 'Step 1', agentId: agent.id},
                {name: 'Step 2', agentId: agent.id}
            ]);
            system.createPost(system.walletAddress, 'Hello from I-AM-SYSTEMS Premium! üåå This is a demo post showcasing the social feed.');
            await system.addKnowledge('Demo Source', 'text', 'This is demonstration knowledge content for the AI knowledge base.');
            await system.uploadVideo('Demo Video', 'A demonstration video showcasing the platform', '10:45');
            await system.executeSwap('IAM', 'ETH', 10);
            
            setTimeout(() => {
                showNotification('Complete', 'Demo complete! Explore all tabs.', 'success');
                updateStatus();
            }, 1000);
        }

        function showNotification(title, message, type = 'success') {
            const n = document.createElement('div');
            n.className = `notification ${type}`;
            n.innerHTML = `
                <div class="notification-content">
                    <div class="notification-icon">${type === 'success' ? '‚úì' : '‚úó'}</div>
                    <div class="notification-text">
                        <div class="notification-title">${title}</div>
                        <div class="notification-message">${message}</div>
                    </div>
                </div>
            `;
            document.body.appendChild(n);
            setTimeout(() => {
                n.style.opacity = '0';
                setTimeout(() => n.remove(), 300);
            }, 3000);
        }

        function updateStatus() {
            document.getElementById('agents-count').textContent = system.agents.length;
            document.getElementById('posts-count').textContent = system.posts.length;
            document.getElementById('videos-count').textContent = system.videos.length;
            document.getElementById('knowledge-count').textContent = system.knowledgeBase.length;
        }

        // Initialize
        setTimeout(() => {
            renderTab('home');
            updateStatus();
            showNotification('Welcome', 'üåå I-AM-SYSTEMS Premium Ready!', 'success');
        }, 500);
    </script>
</body>
</html>
